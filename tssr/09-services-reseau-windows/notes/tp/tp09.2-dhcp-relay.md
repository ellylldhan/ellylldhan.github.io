title: tp09.2 - DHCP Relay

# ENI TSSR 09 - Services Réseaux Windows

[TOC]

## TP 09.2 - DHCP et les réseaux

### Objectifs

Configuration du service DHCP dans une infrastructure routée.


### Résumé des paramètres

<table>
  <thead>
    <tr>
      <th class="header_nom_vm">Nom VM :</th>
      <th>Modele_SRV<sup class="red-star">*</sup></th>
      <th>Modele_client<sup class="red-star">*</sup></th>
      <th>CD01 (DNS)</th>
      <th>SRV01 (DHCP)</th>
      <th>W10</th>
      <th>client2</th>
      <th>rtr17 (routeur)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Type</th>
      <td> Template srv</td>
      <td> Template client</td>
      <td> Ctlr de domaine </td>
      <td> Serveur </td>
      <td> Poste client </td>
      <td> Poste client </td>
      <td> pfsense </td>
    </tr>
    <tr>
      <th>Utilisateur</th>
      <td> Administrateur </td>
      <td> Admin </td>
      <td> Admininstrateur </td>
      <td> Admin </td>
      <td> Admin </td>
      <td> Admin </td>
      <td> Admin </td>
    </tr>
    <tr>
      <th>mdp</th>
      <td colspan="7" style="text-align: center;"> !Admin123 </td>
    </tr>
    <tr>
      <th>ip</th>
      <td>n/a </td>
      <td>n/a </td>
      <td> 172.23.17.1 </td>
      <td> 172.23.17.2 </td>
      <td> 172.23.17.11 (dhcp)</td>
      <td> 172.23.17.20 (dhcp)</td>
      <td> 172.23.17.254</td>
    </tr>
    <tr>
      <th>OS</th>
      <td> WinSrv2019</td>
      <td> Win10 Pro</td>
      <td> WinSrv2019</td>
      <td> WinSrv2019</td>
      <td> Win10 Pro</td>
      <td> Win10 Pro</td>
      <td> pfsense </td>
    </tr>
    <tr>
      <th>CPU</th>
      <td> 1x1 </td>
      <td> 2x1 </td>
      <td> 1x1 </td>
      <td> 1x1 </td>
      <td> 2x1 </td>
      <td> 2x1 </td>
      <td> 1x1 </td>
    </tr>
    <tr>
      <th>RAM</th>
      <td> 4 Go </td>
      <td> 2 Go </td>
      <td> 4 Go </td>
      <td> 4 Go </td>
      <td> 2 Go </td>
      <td> 2 Go </td>
      <td> 1 Go </td>
    </tr>
    <tr>
      <th>NIC</th>
      <td> Host-Only </td>
      <td> Host-Only </td>
      <td> Host-Only </td>
      <td> Host-Only </td>
      <td> Host-Only </td>
      <td> Host-Only </td>
      <td> 2x Host-Only + 1x Bridged</td>
    </tr>
    <tr>
      <th>HDD</th>
      <td> 1x 32 Go </td>
      <td> 1x 32 Go </td>
      <td> 1x 32 Go + 3x 10 Go </td>
      <td> 1x 32 Go </td>
      <td> 1x 32 Go</td>
      <td> 1x 32 Go </td>
      <td> 1x 20 Go </td>
    </tr>
</tbody>
</table>

<span class="attention"><sup class="red-star">\*</sup>ATTENTION <u>NE PAS REDEMARRER</u> LES MODELES UNE FOIS CLONÉS ! </span>

<table>
  <thead>
    <tr>
      <th>Service</th>
      <th>Utilisateur</th>
      <th>Fonction</th>
      <th>login</th>
      <th>mdp</th>
    </tr>
  </thead>
  <tbody>
    <tr>
        <td scope="row" rowspan="4" class="vert-align-mid td-commercial">Commercial</td>    
        <td>Camille</td>
        <td>Secrétaire</td>
        <td>camille / camille@renaud.lcl</td>
        <td>!User123</td>
    </tr>
    <tr>
        <td>Inès</td>  
        <td>Intérimaire</td>  
        <td>ines / ines@renaud.lcl</td>
        <td>!User123</td>
    </tr>
    <tr>
        <td>Claude</td>  
        <td></td>  
        <td>claude / claude@renaud.lcl</td>
        <td>!User123</td>
    </tr>
    <tr>
        <td>Corentin</td>  
        <td></td>  
        <td>corentin / corentin@renaud.lcl</td>
        <td>!User123</td>
    </tr>
    <tr>
        <td scope="row" rowspan="4" class="vert-align-mid td-informatique">Informatique</td>    
        <td>Sophie</td>
        <td>Secrétaire</td>
        <td>sophie / sophie@renaud.lcl</td>
        <td>!User123</td>
    </tr>
        <tr>
        <td>Reno</td>  
        <td></td>  
        <td>Reno / Reno@renaud.lcl</td>
        <td>!User123</td>
    </tr>
    <tr>
        <td>Samir</td>  
        <td></td>  
        <td>samir / samir@renaud.lcl</td>
        <td>!User123</td>
    </tr>
    <tr>
        <td>Stéphane</td>  
        <td></td>  
        <td>stephane / stephane@renaud.lcl</td>
        <td>!User123</td>
    </tr>
       <tr>
        <td scope="row" rowspan="4" class="vert-align-mid td-production">Production</td>    
        <td>Isabelle</td>
        <td>Intérimaire</td>
        <td>Isabelle / Isabelle@renaud.lcl</td>
        <td>!User123</td>
    </tr>
        <tr>
        <td>Pascal</td>  
        <td></td>  
        <td>Pascal / Pascal@renaud.lcl</td>
        <td>!User123</td>
    </tr>
    <tr>
        <td>Paul</td>  
        <td></td>  
        <td>Paul / Paul@renaud.lcl</td>
        <td>!User123</td>
    </tr>
    <tr>
        <td>Philippe</td>  
        <td></td>  
        <td>Philippe / Philippe@renaud.lcl</td>
        <td>!User123</td>
    </tr>
  </tbody>
</table>


### Principales tâches à réaliser

En binôme, réaliser un schéma des infrastructures.

#### 1. A fournit des baux à B
Le 1er stagiaire fournit des baux DHCP aux postes clients du 2e stagiaire. 

- Paramétrer les serveurs dans l'infra du 1er stagiaire
	+ Définir une nouvelle plage d'adresses IP pour le réseau Host-Only du voisin avec les paramétrages adaptés.

- Paramétrer les serveurs dans l'infra du 2e stagiaire
	+ Arrêter le service DHCP.
	+ Mettre en place un relai DHCP.

- Tester le bon fonctionnement 
	+ Vérifier sur un poste client du 2e staigiaire l'obtention d'une IP adaptée.
	+ Vérifier la connectivité avec le réseau Host-Only du 1er stagiaire.

#### 2. B fournit des baux à A
Le 2e stagiaire fournit des baux DHCP aux postes clients du 1er stagiaire.

- Inverser les rôles
	+ le premier stagiaire arrête son service DHCP.
	+ Le 2e stagiaire fournit des adresses ip aux postes du 1er stagiaire.
	+ Définir et mettre en oeuvre les paramètres adaptés.

- Tester le bon fonctionnement 
	+ Vérifier sur le poste client du 1er stagiaire.
	+ Vérifier la connectivité avec le réseau Host-Only du 2e stagiaire. 
	

#### Bonus
A l'aide de Wireshark, l'outil d'analyse de trames, réaliser une capture des échanges entre le client et le serveur DHCP lorsque le poste obtient une adresse ip. 

Lister les types de trames DHCP échangées et détailler les informations transmises.





<link rel="stylesheet" type="text/css" href="../.ressources/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="../.ressources/css/style.css">
