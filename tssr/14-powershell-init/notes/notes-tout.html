<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><style>body {
  max-width: 980px;
  outline: 1300px solid #fff;
  margin: 16px auto;
}

body .markdown-body
{
  padding: 45px;
}

@font-face {
  font-family: fontawesome-mini;
  src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}

.markdown-body {
  font-family: sans-serif;
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
  color: #333333;
  overflow: hidden;
  font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif;
  font-size: 16px;
  line-height: 1.6;
  word-wrap: break-word;
}

.markdown-body a {
  background: transparent;
}

.markdown-body a:active,
.markdown-body a:hover {
  outline: 0;
}

.markdown-body b,
.markdown-body strong {
  font-weight: bold;
}

.markdown-body mark {
  background: #ff0;
  color: #000;
  font-style: italic;
  font-weight: bold;
}

.markdown-body sub,
.markdown-body sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
.markdown-body sup {
  top: -0.5em;
}
.markdown-body sub {
  bottom: -0.25em;
}

.markdown-body h1 {
  font-size: 2em;
  margin: 0.67em 0;
}

.markdown-body img {
  border: 0;
}

.markdown-body hr {
  -moz-box-sizing: content-box;
  box-sizing: content-box;
  height: 0;
}

.markdown-body pre {
  overflow: auto;
}

.markdown-body code,
.markdown-body kbd,
.markdown-body pre,
.markdown-body samp {
  font-family: monospace, monospace;
  font-size: 1em;
}

.markdown-body input {
  color: inherit;
  font: inherit;
  margin: 0;
}

.markdown-body html input[disabled] {
  cursor: default;
}

.markdown-body input {
  line-height: normal;
}

.markdown-body input[type="checkbox"] {
  box-sizing: border-box;
  padding: 0;
}

.markdown-body table {
  border-collapse: collapse;
  border-spacing: 0;
}

.markdown-body td,
.markdown-body th {
  padding: 0;
}

.markdown-body .codehilitetable,
.markdown-body .highlighttable {
  border: 0;
  border-spacing: 0;
}

.markdown-body .codehilitetable tr,
.markdown-body .highlighttable {
  border: 0;
}

.markdown-body .codehilitetable pre,
.markdown-body .codehilitetable div.codehilite,
.markdown-body .highlighttable pre,
.markdown-body .highlighttable div.highlight {
  margin: 0;
}

.markdown-body .linenos,
.markdown-body .code,
.markdown-body .codehilitetable td,
.markdown-body .highlighttable td {
  border: 0;
  padding: 0;
}

.markdown-body td:not(.linenos) .linenodiv {
  padding: 0 !important;
}

.markdown-body .code {
  width: 100%;
}

.markdown-body .linenos div pre,
.markdown-body .linenodiv pre,
.markdown-body .linenodiv {
  border: 0;
  -webkit-border-radius: 0;
  -moz-border-radius: 0;
  border-radius: 0;
  -webkit-border-top-left-radius: 3px;
  -webkit-border-bottom-left-radius: 3px;
  -moz-border-radius-topleft: 3px;
  -moz-border-radius-bottomleft: 3px;
  border-top-left-radius: 3px;
  border-bottom-left-radius: 3px;
}

.markdown-body .code div pre,
.markdown-body .code div {
  border: 0;
  -webkit-border-radius: 0;
  -moz-border-radius: 0;
  border-radius: 0;
  -webkit-border-top-right-radius: 3px;
  -webkit-border-bottom-right-radius: 3px;
  -moz-border-radius-topright: 3px;
  -moz-border-radius-bottomright: 3px;
  border-top-right-radius: 3px;
  border-bottom-right-radius: 3px;
}

.markdown-body * {
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

.markdown-body input {
  font: 13px Helvetica, arial, freesans, clean, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol";
  line-height: 1.4;
}

.markdown-body a {
  color: #4183c4;
  text-decoration: none;
}

.markdown-body a:hover,
.markdown-body a:focus,
.markdown-body a:active {
  text-decoration: underline;
}

.markdown-body hr {
  height: 0;
  margin: 15px 0;
  overflow: hidden;
  background: transparent;
  border: 0;
  border-bottom: 1px solid #ddd;
}

.markdown-body hr:before,
.markdown-body hr:after {
  display: table;
  content: " ";
}

.markdown-body hr:after {
  clear: both;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  margin-top: 15px;
  margin-bottom: 15px;
  line-height: 1.1;
}

.markdown-body h1 {
  font-size: 30px;
}

.markdown-body h2 {
  font-size: 21px;
}

.markdown-body h3 {
  font-size: 16px;
}

.markdown-body h4 {
  font-size: 14px;
}

.markdown-body h5 {
  font-size: 12px;
}

.markdown-body h6 {
  font-size: 11px;
}

.markdown-body blockquote {
  margin: 0;
}

.markdown-body ul,
.markdown-body ol {
  padding: 0;
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body ol ol,
.markdown-body ul ol {
  list-style-type: lower-roman;
}

.markdown-body ul ul ol,
.markdown-body ul ol ol,
.markdown-body ol ul ol,
.markdown-body ol ol ol {
  list-style-type: lower-alpha;
}

.markdown-body dd {
  margin-left: 0;
}

.markdown-body code,
.markdown-body pre,
.markdown-body samp {
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  font-size: 12px;
}

.markdown-body pre {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body kbd {
  background-color: #e7e7e7;
  background-image: -moz-linear-gradient(#fefefe, #e7e7e7);
  background-image: -webkit-linear-gradient(#fefefe, #e7e7e7);
  background-image: linear-gradient(#fefefe, #e7e7e7);
  background-repeat: repeat-x;
  border-radius: 2px;
  border: 1px solid #cfcfcf;
  color: #000;
  padding: 3px 5px;
  line-height: 10px;
  font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
  display: inline-block;
}

.markdown-body>*:first-child {
  margin-top: 0 !important;
}

.markdown-body>*:last-child {
  margin-bottom: 0 !important;
}

.markdown-body .headerlink {
  font: normal 400 16px fontawesome-mini;
  vertical-align: middle;
  margin-left: -16px;
  float: left;
  display: inline-block;
  text-decoration: none;
  opacity: 0;
  color: #333;
}

.markdown-body .headerlink:focus {
  outline: none;
}

.markdown-body h1 .headerlink {
  margin-top: 0.8rem;
}

.markdown-body h2 .headerlink,
.markdown-body h3 .headerlink {
  margin-top: 0.6rem;
}

.markdown-body h4 .headerlink {
  margin-top: 0.2rem;
}

.markdown-body h5 .headerlink,
.markdown-body h6 .headerlink {
  margin-top: 0;
}

.markdown-body .headerlink:hover,
.markdown-body h1:hover .headerlink,
.markdown-body h2:hover .headerlink,
.markdown-body h3:hover .headerlink,
.markdown-body h4:hover .headerlink,
.markdown-body h5:hover .headerlink,
.markdown-body h6:hover .headerlink {
  opacity: 1;
  text-decoration: none;
}

.markdown-body h1 {
  padding-bottom: 0.3em;
  font-size: 2.25em;
  line-height: 1.2;
  border-bottom: 1px solid #eee;
}

.markdown-body h2 {
  padding-bottom: 0.3em;
  font-size: 1.75em;
  line-height: 1.225;
  border-bottom: 1px solid #eee;
}

.markdown-body h3 {
  font-size: 1.5em;
  line-height: 1.43;
}

.markdown-body h4 {
  font-size: 1.25em;
}

.markdown-body h5 {
  font-size: 1em;
}

.markdown-body h6 {
  font-size: 1em;
  color: #777;
}

.markdown-body p,
.markdown-body blockquote,
.markdown-body ul,
.markdown-body ol,
.markdown-body dl,
.markdown-body table,
.markdown-body pre,
.markdown-body .admonition {
  margin-top: 0;
  margin-bottom: 16px;
}

.markdown-body hr {
  height: 4px;
  padding: 0;
  margin: 16px 0;
  background-color: #e7e7e7;
  border: 0 none;
}

.markdown-body ul,
.markdown-body ol {
  padding-left: 2em;
}

.markdown-body ul ul,
.markdown-body ul ol,
.markdown-body ol ol,
.markdown-body ol ul {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body li>p {
  margin-top: 16px;
}

.markdown-body dl {
  padding: 0;
}

.markdown-body dl dt {
  padding: 0;
  margin-top: 16px;
  font-size: 1em;
  font-style: italic;
  font-weight: bold;
}

.markdown-body dl dd {
  padding: 0 16px;
  margin-bottom: 16px;
}

.markdown-body blockquote {
  padding: 0 15px;
  color: #777;
  border-left: 4px solid #ddd;
}

.markdown-body blockquote>:first-child {
  margin-top: 0;
}

.markdown-body blockquote>:last-child {
  margin-bottom: 0;
}

.markdown-body table {
  display: block;
  width: 100%;
  overflow: auto;
  word-break: normal;
  word-break: keep-all;
}

.markdown-body table th {
  font-weight: bold;
}

.markdown-body table th,
.markdown-body table td {
  padding: 6px 13px;
  border: 1px solid #ddd;
}

.markdown-body table tr {
  background-color: #fff;
  border-top: 1px solid #ccc;
}

.markdown-body table tr:nth-child(2n) {
  background-color: #f8f8f8;
}

.markdown-body img {
  max-width: 100%;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

.markdown-body code,
.markdown-body samp {
  padding: 0;
  padding-top: 0.2em;
  padding-bottom: 0.2em;
  margin: 0;
  font-size: 85%;
  background-color: rgba(0,0,0,0.04);
  border-radius: 3px;
}

.markdown-body code:before,
.markdown-body code:after {
  letter-spacing: -0.2em;
  content: "\00a0";
}

.markdown-body pre>code {
  padding: 0;
  margin: 0;
  font-size: 100%;
  word-break: normal;
  white-space: pre;
  background: transparent;
  border: 0;
}

.markdown-body .codehilite,
.markdown-body .highlight {
  margin-bottom: 16px;
}

.markdown-body .codehilite pre,
.markdown-body .highlight pre,
.markdown-body pre {
  padding: 16px;
  overflow: auto;
  font-size: 85%;
  line-height: 1.45;
  background-color: #f7f7f7;
  border-radius: 3px;
}

.markdown-body .codehilite pre,
.markdown-body .highlight pre {
  margin-bottom: 0;
  word-break: normal;
}

.markdown-body pre {
  word-wrap: normal;
}

.markdown-body pre code {
  display: inline;
  max-width: initial;
  padding: 0;
  margin: 0;
  overflow: initial;
  line-height: inherit;
  word-wrap: normal;
  background-color: transparent;
  border: 0;
}

.markdown-body pre code:before,
.markdown-body pre code:after {
  content: normal;
}

/* Admonition */
.markdown-body .admonition {
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  position: relative;
  border-radius: 3px;
  border: 1px solid #e0e0e0;
  border-left: 6px solid #333;
  padding: 10px 10px 10px 30px;
}

.markdown-body .admonition table {
  color: #333;
}

.markdown-body .admonition p {
  padding: 0;
}

.markdown-body .admonition-title {
  font-weight: bold;
  margin: 0;
}

.markdown-body .admonition>.admonition-title {
  color: #333;
}

.markdown-body .attention>.admonition-title {
  color: #a6d796;
}

.markdown-body .caution>.admonition-title {
  color: #d7a796;
}

.markdown-body .hint>.admonition-title {
  color: #96c6d7;
}

.markdown-body .danger>.admonition-title {
  color: #c25f77;
}

.markdown-body .question>.admonition-title {
  color: #96a6d7;
}

.markdown-body .note>.admonition-title {
  color: #d7c896;
}

.markdown-body .admonition:before,
.markdown-body .attention:before,
.markdown-body .caution:before,
.markdown-body .hint:before,
.markdown-body .danger:before,
.markdown-body .question:before,
.markdown-body .note:before {
  font: normal normal 16px fontawesome-mini;
  -moz-osx-font-smoothing: grayscale;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  line-height: 1.5;
  color: #333;
  position: absolute;
  left: 0;
  top: 0;
  padding-top: 10px;
  padding-left: 10px;
}

.markdown-body .admonition:before {
  content: "\f056\00a0";
  color: 333;
}

.markdown-body .attention:before {
  content: "\f058\00a0";
  color: #a6d796;
}

.markdown-body .caution:before {
  content: "\f06a\00a0";
  color: #d7a796;
}

.markdown-body .hint:before {
  content: "\f05a\00a0";
  color: #96c6d7;
}

.markdown-body .danger:before {
  content: "\f057\00a0";
  color: #c25f77;
}

.markdown-body .question:before {
  content: "\f059\00a0";
  color: #96a6d7;
}

.markdown-body .note:before {
  content: "\f040\00a0";
  color: #d7c896;
}

.markdown-body .admonition::after {
  content: normal;
}

.markdown-body .attention {
  border-left: 6px solid #a6d796;
}

.markdown-body .caution {
  border-left: 6px solid #d7a796;
}

.markdown-body .hint {
  border-left: 6px solid #96c6d7;
}

.markdown-body .danger {
  border-left: 6px solid #c25f77;
}

.markdown-body .question {
  border-left: 6px solid #96a6d7;
}

.markdown-body .note {
  border-left: 6px solid #d7c896;
}

.markdown-body .admonition>*:first-child {
  margin-top: 0 !important;
}

.markdown-body .admonition>*:last-child {
  margin-bottom: 0 !important;
}

/* progress bar*/
.markdown-body .progress {
  display: block;
  width: 300px;
  margin: 10px 0;
  height: 24px;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
  background-color: #ededed;
  position: relative;
  box-shadow: inset -1px 1px 3px rgba(0, 0, 0, .1);
}

.markdown-body .progress-label {
  position: absolute;
  text-align: center;
  font-weight: bold;
  width: 100%; margin: 0;
  line-height: 24px;
  color: #333;
  text-shadow: 1px 1px 0 #fefefe, -1px -1px 0 #fefefe, -1px 1px 0 #fefefe, 1px -1px 0 #fefefe, 0 1px 0 #fefefe, 0 -1px 0 #fefefe, 1px 0 0 #fefefe, -1px 0 0 #fefefe, 1px 1px 2px #000;
  -webkit-font-smoothing: antialiased !important;
  white-space: nowrap;
  overflow: hidden;
}

.markdown-body .progress-bar {
  height: 24px;
  float: left;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
  background-color: #96c6d7;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, .5), inset 0 -1px 0 rgba(0, 0, 0, .1);
  background-size: 30px 30px;
  background-image: -webkit-linear-gradient(
    135deg, rgba(255, 255, 255, .4) 27%,
    transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%,
    transparent 77%, transparent
  );
  background-image: -moz-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: -ms-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: -o-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
}

.markdown-body .progress-100plus .progress-bar {
  background-color: #a6d796;
}

.markdown-body .progress-80plus .progress-bar {
  background-color: #c6d796;
}

.markdown-body .progress-60plus .progress-bar {
  background-color: #d7c896;
}

.markdown-body .progress-40plus .progress-bar {
  background-color: #d7a796;
}

.markdown-body .progress-20plus .progress-bar {
  background-color: #d796a6;
}

.markdown-body .progress-0plus .progress-bar {
  background-color: #c25f77;
}

.markdown-body .candystripe-animate .progress-bar{
  -webkit-animation: animate-stripes 3s linear infinite;
  -moz-animation: animate-stripes 3s linear infinite;
  animation: animate-stripes 3s linear infinite;
}

@-webkit-keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

@-moz-keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

@keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

.markdown-body .gloss .progress-bar {
  box-shadow:
    inset 0 4px 12px rgba(255, 255, 255, .7),
    inset 0 -12px 0 rgba(0, 0, 0, .05);
}

/* MultiMarkdown Critic Blocks */
.markdown-body .critic_mark {
  background: #ff0;
}

.markdown-body .critic_delete {
  color: #c82829;
  text-decoration: line-through;
}

.markdown-body .critic_insert {
  color: #718c00 ;
  text-decoration: underline;
}

.markdown-body .critic_comment {
  color: #8e908c;
  font-style: italic;
}

.markdown-body .headeranchor {
  font: normal normal 16px fontawesome-mini;
  line-height: 1;
  display: inline-block;
  text-decoration: none;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.headeranchor:before {
  content: '\e157';
}

.markdown-body .task-list-item {
  list-style-type: none;
}

.markdown-body .task-list-item+.task-list-item {
  margin-top: 3px;
}

.markdown-body .task-list-item input {
  margin: 0 4px 0.25em -20px;
  vertical-align: middle;
}

.markdown-body diagram-div, .markdown-body div.uml-sequence-diagram, .markdown-body, div.uml-flowchart {
  overflow: auto;
}

/* Media */
@media only screen and (min-width: 480px) {
  .markdown-body {
    font-size:14px;
  }
}

@media only screen and (min-width: 768px) {
  .markdown-body {
    font-size:16px;
  }
}

@media print {
  .markdown-body * {
    background: transparent !important;
    color: black !important;
    filter:none !important;
    -ms-filter: none !important;
  }

  .markdown-body {
    font-size:12pt;
    max-width:100%;
    outline:none;
    border: 0;
  }

  .markdown-body a,
  .markdown-body a:visited {
    text-decoration: underline;
  }

  .markdown-body .headeranchor-link {
    display: none;
  }

  .markdown-body a[href]:after {
    content: " (" attr(href) ")";
  }

  .markdown-body abbr[title]:after {
    content: " (" attr(title) ")";
  }

  .markdown-body .ir a:after,
  .markdown-body a[href^="javascript:"]:after,
  .markdown-body a[href^="#"]:after {
    content: "";
  }

  .markdown-body pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  .markdown-body pre,
  .markdown-body blockquote {
    border: 1px solid #999;
    padding-right: 1em;
    page-break-inside: avoid;
  }

  .markdown-body .progress,
  .markdown-body .progress-bar {
    -moz-box-shadow: none;
    -webkit-box-shadow: none;
    box-shadow: none;
  }

  .markdown-body .progress {
    border: 1px solid #ddd;
  }

  .markdown-body .progress-bar {
    height: 22px;
    border-right: 1px solid #ddd;
  }

  .markdown-body tr,
  .markdown-body img {
    page-break-inside: avoid;
  }

  .markdown-body img {
    max-width: 100% !important;
  }

  .markdown-body p,
  .markdown-body h2,
  .markdown-body h3 {
    orphans: 3;
    widows: 3;
  }

  .markdown-body h2,
  .markdown-body h3 {
    page-break-after: avoid;
  }
}
</style><style>/*GitHub*/
.highlight {background-color:#fff;color:#333333;}
.highlight .hll {background-color:#ffffcc;}
.highlight .c{color:#999988;font-style:italic}
.highlight .err{color:#a61717;background-color:#e3d2d2}
.highlight .k{font-weight:bold}
.highlight .o{font-weight:bold}
.highlight .cm{color:#999988;font-style:italic}
.highlight .cp{color:#999999;font-weight:bold}
.highlight .c1{color:#999988;font-style:italic}
.highlight .cs{color:#999999;font-weight:bold;font-style:italic}
.highlight .gd{color:#000000;background-color:#ffdddd}
.highlight .ge{font-style:italic}
.highlight .gr{color:#aa0000}
.highlight .gh{color:#999999}
.highlight .gi{color:#000000;background-color:#ddffdd}
.highlight .go{color:#888888}
.highlight .gp{color:#555555}
.highlight .gs{font-weight:bold}
.highlight .gu{color:#800080;font-weight:bold}
.highlight .gt{color:#aa0000}
.highlight .kc{font-weight:bold}
.highlight .kd{font-weight:bold}
.highlight .kn{font-weight:bold}
.highlight .kp{font-weight:bold}
.highlight .kr{font-weight:bold}
.highlight .kt{color:#445588;font-weight:bold}
.highlight .m{color:#009999}
.highlight .s{color:#dd1144}
.highlight .n{color:#333333}
.highlight .na{color:teal}
.highlight .nb{color:#0086b3}
.highlight .nc{color:#445588;font-weight:bold}
.highlight .no{color:teal}
.highlight .ni{color:purple}
.highlight .ne{color:#990000;font-weight:bold}
.highlight .nf{color:#990000;font-weight:bold}
.highlight .nn{color:#555555}
.highlight .nt{color:navy}
.highlight .nv{color:teal}
.highlight .ow{font-weight:bold}
.highlight .w{color:#bbbbbb}
.highlight .mf{color:#009999}
.highlight .mh{color:#009999}
.highlight .mi{color:#009999}
.highlight .mo{color:#009999}
.highlight .sb{color:#dd1144}
.highlight .sc{color:#dd1144}
.highlight .sd{color:#dd1144}
.highlight .s2{color:#dd1144}
.highlight .se{color:#dd1144}
.highlight .sh{color:#dd1144}
.highlight .si{color:#dd1144}
.highlight .sx{color:#dd1144}
.highlight .sr{color:#009926}
.highlight .s1{color:#dd1144}
.highlight .ss{color:#990073}
.highlight .bp{color:#999999}
.highlight .vc{color:teal}
.highlight .vg{color:teal}
.highlight .vi{color:teal}
.highlight .il{color:#009999}
.highlight .gc{color:#999;background-color:#EAF2F5}
</style><title>notes-tout</title></head><body><article class="markdown-body"><h1 id="eni-tssr-14-powershell">ENI TSSR 14 - Powershell<a class="headerlink" href="#eni-tssr-14-powershell" title="Permanent link"></a></h1>
<p>Cours &ldquo;Initiation au scripting Powershell&rdquo; @ ENI (2022)</p>
<table>
<tr><th>Dates     :</th><td>du 28/11 au 02/12/2022</td></tr>
<tr><th>Formateur :</th><td>Thélo GUYADER</td></tr>
</table>

<p>id: 140</p>
<div class="toc">
<ul>
<li><a href="#eni-tssr-14-powershell">ENI TSSR 14 - Powershell</a><ul>
<li><a href="#notes">Notes</a><ul>
<li><a href="#evolution-de-powershell">Evolution de PowerShell</a></li>
<li><a href="#particularites-de-powershell-core">Particularités de PowerShell Core</a><ul>
<li><a href="#comparaison-net-framework-vs-net-core">Comparaison .NET Framework -vs- .NET Core</a></li>
</ul>
</li>
<li><a href="#notes_1">Notes</a></li>
<li><a href="#les-cmdlets">Les Cmdlets</a></li>
<li><a href="#get-command">Get-Command</a></li>
<li><a href="#get-help">Get-Help</a></li>
<li><a href="#update-help">Update-Help</a></li>
<li><a href="#la-commande-de-protection">La commande de protection</a></li>
<li><a href="#les-modules">Les modules</a><ul>
<li><a href="#ajouter-un-module">Ajouter un module</a></li>
</ul>
</li>
<li><a href="#la-personnalisation-de-la-console">La personnalisation de la console</a></li>
</ul>
</li>
<li><a href="#tp-1-presentation">TP 1 - Présentation</a></li>
<li><a href="#module-2-powershell-langage-objet">Module 2 : PowerShell Langage Objet</a><ul>
<li><a href="#get-member">Get-Member</a></li>
<li><a href="#les-objets-methodes">Les objets : methodes</a></li>
<li><a href="#tp-02-objet">TP 02 - Objet</a></li>
</ul>
</li>
<li><a href="#module-03-manipulation-des-objets">Module 03 - Manipulation des objets</a><ul>
<li><a href="#manipuler-des-objets">Manipuler des objets</a><ul>
<li><a href="#pipeline">Pipeline</a></li>
<li><a href="#select-object">Select-Object</a></li>
<li><a href="#sort-object">Sort-Object</a></li>
<li><a href="#measure-object">Measure-Object</a></li>
<li><a href="#where-objet">Where-Objet</a><ul>
<li><a href="#or-and-filterscript">OR / AND &amp; FilterScript</a></li>
<li><a href="#collaboration-de-conditions">Collaboration de conditions</a></li>
</ul>
</li>
<li><a href="#format-table">Format-Table</a></li>
<li><a href="#format-wide">Format-Wide</a></li>
<li><a href="#format-list">Format-List</a></li>
<li><a href="#export-object">Export-Object</a></li>
<li><a href="#out-file">Out-File</a></li>
<li><a href="#get-content">Get-Content</a></li>
<li><a href="#import-csv">Import-CSV</a></li>
</ul>
</li>
<li><a href="#les-proprietes-calculees">Les propriétés calculées</a></li>
</ul>
</li>
<li><a href="#module-4-structures-et-variables">Module 4 - Structures et Variables</a><ul>
<li><a href="#structures-de-controle">Structures de contrôle</a><ul>
<li><a href="#if">if</a></li>
<li><a href="#while-do-while">while / do while</a></li>
<li><a href="#until-do-until">until / do until</a></li>
<li><a href="#for">for</a></li>
<li><a href="#foreach">foreach</a></li>
<li><a href="#switch">switch</a></li>
</ul>
</li>
<li><a href="#caracteristiques">Caractéristiques</a><ul>
<li><a href="#incrementation">Incrémentation</a></li>
<li><a href="#concatenation-1">Concaténation 1</a></li>
<li><a href="#definition-affectation-de-variable">Définition / Affectation de variable</a></li>
<li><a href="#acces-variable">Accès Variable</a></li>
<li><a href="#comment">Comment</a></li>
<li><a href="#specificites-powershell">Spécificités Powershell</a></li>
<li><a href="#lire-input">Lire input</a></li>
<li><a href="#ecrire-output">Ecrire output</a></li>
<li><a href="#variables-de-type-object">Variables de type Object</a></li>
<li><a href="#convertisseur-de-valeur-transtypage">Convertisseur de valeur (transtypage ?)</a></li>
<li><a href="#concatenation-de-string-operateur">Concaténation de string (opérateur +)</a></li>
</ul>
</li>
<li><a href="#operations-multi-types">Opérations multi-types</a></li>
<li><a href="#type-int">Type Int</a></li>
<li><a href="#type-array">Type Array</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<h2 id="notes">Notes<a class="headerlink" href="#notes" title="Permanent link"></a></h2>
<h3 id="evolution-de-powershell">Evolution de PowerShell<a class="headerlink" href="#evolution-de-powershell" title="Permanent link"></a></h3>
<p>Sorti en 2006, PowerShell v1.0 était disponible sur les systèmes WinXP SP2, Vista et WinServer 2003 SP1. Cette première version apporte 129 commandes réparties sur 5 modules.</p>
<p>La version 5.1 est actuellement installée par défaut sur Win10 et WinServer 2019. Elle met à disposition 2855 commandes et supporte plusieurs milliers de modules, notamment Azure et Exchange.</p>
<p>Chaque montée de version apporte de nouvelles commandes (cmdlets et fonctions), des màj de commandes existantes et de nouveaux modules. L&rsquo;interpréteur PowerShell est également mis à jour.</p>
<p>De grands éditeurs ont développé des modules permettant de piloter leurs plateformes et produits depuis PowerShell.</p>
<p>Depuis 2016, dans la lignée des Frameworks .NET deux ans auparavant, PowerShell est passé en Open Source. La montée en version de PowerShell Core suit les évolutions du Framework DotNet Core actuellement en version 3. PowerShell Core est en version 7.0</p>
<p>Powershell 7 (Core) est cross platform, mais permet surtout de contrôler des machines Windows depuis un Linux. PS7 ne sert pas à gérer un système Linux, montre assez vite ses limites. La version Core permet également de créer ses propres modules.</p>
<p>C&rsquo;est une évolution majeur de Microsoft ces dernières années, démontrant une volonté d&rsquo;ouverture vers d&rsquo;autres environnements (ex. intégration de Bash dans Win10, SQL Server porté sur Linux, ouverture d&rsquo;Azure vers l&rsquo;univers Linux, etc.).</p>
<h3 id="particularites-de-powershell-core">Particularités de PowerShell Core<a class="headerlink" href="#particularites-de-powershell-core" title="Permanent link"></a></h3>
<ul>
<li>Pas de requêtes WMI ou CIM (propres aux systèmes Windows). Certaines commandes utilisant du WMI sont donc indisponibles.</li>
<li>Pas de planification de tâches via cmdlets</li>
<li>Certains alias ne sont pas disponibles</li>
<li>Utilisation du Remoting PowerShell impossible</li>
<li>Sous Linux, on respecte la casse !</li>
<li>Certaines incompatibilités sur des fonctions avec des scripts Windows</li>
</ul>
<p>Quelques alias ne fonctionnent pas, ex. ls, cp, mv, rm, cat, man, mount et ps. Les commandes passent bien car natives mais dans le cas d&rsquo;un ls, on perd l&rsquo;objet et on remonte du texte.</p>
<h4 id="comparaison-net-framework-vs-net-core">Comparaison .NET Framework -vs- .NET Core<a class="headerlink" href="#comparaison-net-framework-vs-net-core" title="Permanent link"></a></h4>
<p>Powershell sous Linux/MacOS utilise la version CORE qui est un sous-ensemble de la version complète de .NET Framework sous Microsoft Windows. C&rsquo;est un point important, car PowerShell offre un accès direct aux méthodes, types de Framework, etc. sous-jacents.</p>
<p>Par conséquent, les scripts qui s&rsquo;exécutent sous Windows risquent de ne pas fonctionner sur les plateformes autres que Windows en raison des différences d&rsquo;infrastucture.</p>
<p>Avec l&rsquo;arrivée de .NET Standard 2.0, .NET Core 2.0 réintégrera la plupart des types et méthodes traditionnels présents dans la version complète du .NET Framework. PowerShell Core pourra donc charger de nombreux modules Windows Powershell traditionnels sans modification.</p>
<h3 id="notes_1">Notes<a class="headerlink" href="#notes_1" title="Permanent link"></a></h3>
<p>PS manipule des objets.</p>
<p>Base SAM = Security Account Management</p>
<h3 id="les-cmdlets">Les Cmdlets<a class="headerlink" href="#les-cmdlets" title="Permanent link"></a></h3>
<p>Les commandes PS sont toujours composées ainsi : <strong>Verbe-Nom</strong>. Attention, le nom sera <strong>toujours au singulier</strong>.</p>
<p>Exemple : <code>Get-ChildItem</code>, <code>Get-Service</code>, <code>Get-Volume</code>, <code>Get-SMBShare</code>, <code>Get-Process</code>, <code>Get-Item</code></p>
<ul>
<li>
<p>Les commandes PS disposent de paramètres nécessaires au bon fonctionnement de la commande
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-LocalUser</span> <span class="n">-Name</span> <span class="s2">&quot;Nom de l&#39;utilisateur recherché&quot;</span>
</pre></div></p>
</li>
<li>
<p>Le paramètre est systématiquement indiqué avec un tiret. Une commande peut disposer de plusieurs paramètres.
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-LocalGroupMember</span> <span class="n">-Group</span> <span class="s2">&quot;Nom du groupe recherché&quot;</span> <span class="n">-Member</span> <span class="s2">&quot;Membre du groupe recherché dans le groupe indiqué&quot;</span>
</pre></div></p>
</li>
</ul>
<h3 id="get-command">Get-Command<a class="headerlink" href="#get-command" title="Permanent link"></a></h3>
<p>Permet de rechercher une commande.</p>
<ol>
<li>
<p>La recherche peut se faire sur le paramètre <code>-Name</code>. Note: Prend des wildcards <code>*</code>.
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">get-command</span> <span class="n">-Name</span> <span class="p">*</span><span class="n">-Service</span>
</pre></div></p>
</li>
<li>
<p>La recherche peut se faire sur le paramètre <code>-Verb</code>
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Command</span> <span class="n">-Verb</span> <span class="n">stop</span>
</pre></div></p>
</li>
</ol>
<h3 id="get-help">Get-Help<a class="headerlink" href="#get-help" title="Permanent link"></a></h3>
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Help</span> <span class="n">-Name</span> <span class="nb">Get-Service</span>
</pre></div>

<p>Options disponibles :</p>
<ul>
<li><code>-Full</code>: aide complète</li>
<li><code>-Online</code>: aide en ligne donc la plus récente. Requiert une connection Internet.</li>
<li><code>-Examples</code>: affiche que des exemples d&rsquo;utilisation</li>
<li><code>-ShowWindow</code>: affiche dans une popup en dehors du terminal, offrant une option de filtrage, la possibilité de copier-coller, etc.</li>
</ul>
<p>Pour en savoir plus, ne pas hésiter d&rsquo;aller voir&hellip; <code>Get-Help Get-Help</code>.</p>
<h3 id="update-help">Update-Help<a class="headerlink" href="#update-help" title="Permanent link"></a></h3>
<ul>
<li>
<p>Mettre à jour en ligne
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">update-help</span>
</pre></div></p>
</li>
<li>
<p>Spécifier la source locale
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">update-help</span> <span class="n">-SourcePath</span> <span class="n">D</span><span class="err">:</span><span class="p">\</span><span class="n">Powershell</span>
</pre></div></p>
</li>
<li>
<p>Spécifier un langage
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Update-Help</span> <span class="n">-SourcePath</span> <span class="n">D</span><span class="err">:</span><span class="p">\</span><span class="n">Powershell</span> <span class="n">-UICulture</span> <span class="n">en-GB</span>
</pre></div></p>
</li>
</ul>
<h3 id="la-commande-de-protection">La commande de protection<a class="headerlink" href="#la-commande-de-protection" title="Permanent link"></a></h3>
<p>L&rsquo;exécution de script est par défaut soumise à une forte restriction.</p>
<p>Le niveau de confiance requis pour l&rsquo;exécution est modifiable :</p>
<ul>
<li>Permet d&rsquo;exécuter tous les scripts. A executer dans un CLI avec les droits admin :
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Set-ExecutionPolicy</span> <span class="n">-ExecutionPolicy</span> <span class="n">Unrestricted</span>
</pre></div></li>
</ul>
<p><strong>Niveaux de confiance</strong>:</p>
<ul>
<li>Niveau Secu elevé<ul>
<li><strong>Restricted</strong> (par défaut) : aucune execution possible.</li>
<li><strong>AllSigned</strong> : Tous les scripts doivent être signés par une autorité de certification de confiance, y compris ceux écrits sur la machine.</li>
<li><strong>RemoteSigned</strong> : Nécessite que tous les scripts provenant du net soient signés par une autorité de certification de confiance.</li>
</ul>
</li>
<li>Niveau Secu limité<ul>
<li><strong>Unrestricted</strong> : Pas de restrictions particulières sur les scripts. Ceux provenant d&rsquo;internant déclenche un avertissement.</li>
<li><strong>Bypass</strong> (open bar) : Open bar</li>
</ul>
</li>
<li>Niveau autre<ul>
<li><strong>Default</strong></li>
<li><strong>Undefined</strong> : Remove the currently assigned execution policy from the current scope. This parameter will not remove an execution policy that is set in a Group Policy scope.</li>
</ul>
</li>
</ul>
<p><strong>Attention</strong> ces commandes nécessitent un PowerShell avec les droits admin.</p>
<h3 id="les-modules">Les modules<a class="headerlink" href="#les-modules" title="Permanent link"></a></h3>
<p>Chaque cmdlet provient d&rsquo;un module Powershell.</p>
<p>Les modules sont des fichiers portant extension <strong>.PSM1</strong>.</p>
<p>La commande <code>Get-Module</code> permet de voir les modules actuellement disponible dans PS.</p>
<h4 id="ajouter-un-module">Ajouter un module<a class="headerlink" href="#ajouter-un-module" title="Permanent link"></a></h4>
<ol>
<li>
<p>Après la récupération d&rsquo;un fichier PSM1 pour connaître l&rsquo;emplacement disponible, il faut saisir la commande :
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nv">$env:PsModulePath</span>
</pre></div></p>
</li>
<li>
<p>Après la copie du fichier dans l&rsquo;emplacement; on importe le module dans la console :
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Import-Module</span> <span class="n">-Name</span> <span class="s2">&quot;Le nom du dossier contenant le module&quot;</span>
</pre></div></p>
</li>
<li>
<p>Puis on vérifie l&rsquo;installation :
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Command</span> <span class="n">-module</span> <span class="s2">&quot;Le nom du module&quot;</span>
</pre></div></p>
</li>
</ol>
<p><strong>Important</strong> :</p>
<ul>
<li>Ces commandes nécessitent un Powershell avec les droits admin.</li>
<li>Il faut modifier les droits d&rsquo;execution de script sur le système.</li>
</ul>
<h3 id="la-personnalisation-de-la-console">La personnalisation de la console<a class="headerlink" href="#la-personnalisation-de-la-console" title="Permanent link"></a></h3>
<p>L&rsquo;équivalent .bashrc existe sous PS. Cette commande va créer un fichier pour le profil :
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">New-item</span> <span class="n">-Path</span> <span class="nv">$Profile</span> <span class="n">-Type</span> <span class="n">File</span> <span class="n">-Force</span>
</pre></div></p>
<p>Va générer un fichier dans le <strong>%USERPROFILE%/Documents/WindowsPowershell</strong> que l&rsquo;on pourra modifier (ex. créer des alias, des variables supplémentaires, modifier le prompt)</p>
<p>Attention, le fichier en <strong>.ps1</strong> généré est vide. Il s&rsquo;agira d&rsquo;y ajouter une fonction <code>prompt</code> définissant les paramètres du prompt (avec des <code>write-host</code>). Cette fonction sera chargée à chaque ouverture de CLI.</p>
<h2 id="tp-1-presentation">TP 1 - Présentation<a class="headerlink" href="#tp-1-presentation" title="Permanent link"></a></h2>
<p><a href="tp01.html" target="_blank">Voir Atelier 1 - Présentation</a></p>
<div class="highlight"><pre><span class="c"># Count how many commands</span>
<span class="nb">get-command</span> <span class="p">|</span> <span class="n">measure</span>
<span class="nb">get-command</span> <span class="p">|</span> <span class="n">measure</span> <span class="p">|</span> <span class="n">select</span> <span class="n">count</span>
<span class="p">(</span><span class="nb">get-command</span><span class="p">).</span><span class="n">count</span>

<span class="c"># Get All Verbs</span>
<span class="nb">get-command</span> <span class="p">|</span> <span class="n">select</span> <span class="n">verb</span> <span class="p">|</span> <span class="nb">Group-Object</span> <span class="n">verb</span>
<span class="nb">get-verb</span>

<span class="c"># Get All Verbs containing *new*</span>
<span class="nb">get-command</span> <span class="p">|</span> <span class="n">select</span> <span class="n">verb</span> <span class="p">|</span> <span class="nb">Group-Object</span> <span class="n">verb</span> <span class="p">|</span> <span class="n">where</span> <span class="n">Name</span> <span class="o">-like</span> <span class="n">new</span>
<span class="nb">get-command</span> <span class="n">-verb</span> <span class="n">new</span>

<span class="c"># Get all commands containing *user*</span>
<span class="nb">get-command</span> <span class="p">*</span><span class="n">user</span><span class="p">*</span>

<span class="c"># Création user</span>
<span class="nv">$mdp</span><span class="p">=</span><span class="nb">Read-Host</span> <span class="n">-AsSecureString</span>
<span class="nb">new-localuser</span> <span class="s2">&quot;user_tp01&quot;</span> <span class="n">-Password</span> <span class="nv">$mdp</span> <span class="n">-FullName</span> <span class="s2">&quot;Utilisateur Local TP01&quot;</span> <span class="n">-UserMayNotChangePassword</span> <span class="n">-PasswordNeverExpires</span>

<span class="c"># Get first 5 local users</span>
<span class="nb">Get-LocalUser</span> <span class="p">|</span> <span class="n">select</span> <span class="n">-First</span> <span class="n">5</span>

<span class="c"># Update 1 user</span>
<span class="nb">Set-localuser</span> <span class="n">-Description</span> <span class="s2">&quot;Utilisateur std modifié&quot;</span>  <span class="n">FerdinandMorse</span>

<span class="c"># Get Get-Help</span>
<span class="nb">get-help</span> <span class="nb">get-Service</span> <span class="n">-ShowWindow</span>      <span class="c"># dans fenêtre à part</span>
<span class="nb">get-help</span> <span class="nb">get-Service</span> <span class="n">-Full</span>            <span class="c"># totalité dispo</span>
<span class="nb">get-help</span> <span class="n">-Online</span> <span class="nb">Get-LocalGroupMember</span> <span class="c"># online</span>

<span class="c"># Update-Help d&#39;après un package</span>
<span class="nb">update-help</span> <span class="n">-SourcePath</span> <span class="p">\\</span><span class="n">CD01</span><span class="p">\</span><span class="n">Partage</span><span class="p">\</span><span class="n">Depot</span><span class="p">\</span><span class="n">CLI01</span>
<span class="nb">update-help</span> <span class="n">-SourcePath</span> <span class="p">\\</span><span class="n">CD01</span><span class="p">\</span><span class="n">Partage</span><span class="p">\</span><span class="n">Depot</span><span class="p">\</span><span class="n">CLI01</span> <span class="n">-UICulture</span> <span class="n">fr-FR</span>

<span class="c"># Get modules actuellement chargés</span>
<span class="nb">Get-Module</span>

<span class="c"># Get issue package</span>
<span class="nb">Get-Command</span> <span class="nb">Get-LocalUser</span>

<span class="c"># Get Module location</span>
<span class="nv">$env:PSModulePath</span>

<span class="c"># Installation d&#39;un module</span>
<span class="c"># 1. Dezip pkg in one folder that is in the module path</span>
<span class="c"># 2. Import module</span>
<span class="nb">Import-Module</span> <span class="n">AWSPowerShell</span>
<span class="c"># 3. Vérification</span>
<span class="nb">Get-Module</span>

<span class="c"># Get first 3 commands available for a module</span>
<span class="nb">Get-Command</span> <span class="n">-module</span> <span class="n">AWSPowershell</span> <span class="p">|</span> <span class="n">select</span> <span class="n">-first</span> <span class="n">3</span>

<span class="c"># Custom Profile</span>
<span class="nb">new-item</span> <span class="n">-path</span> <span class="nv">$profile</span> <span class="n">-type</span> <span class="n">file</span> <span class="n">-force</span>  <span class="c"># voir TP pour contenu de la fonction prompt</span>
</pre></div>

<p class="fin">~Fin Module 1~</p>

<h2 id="module-2-powershell-langage-objet">Module 2 : PowerShell Langage Objet<a class="headerlink" href="#module-2-powershell-langage-objet" title="Permanent link"></a></h2>
<p>Powershell est un langage orienté objet.</p>
<p>Chaque objet pourra porter des <strong>méthodes</strong> et des <strong>propriétés</strong>.</p>
<p>Exemple: <code>Get-Service</code> renvoie un objet <strong>Service Windows</strong></p>
<table>
<thead>
<tr>
<th align="left">Propriétés</th>
<th align="left">Méthodes</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Nom du Service</td>
<td align="left">démarrer le Service</td>
</tr>
<tr>
<td align="left">Type de démarrage</td>
<td align="left">désactiver le Service</td>
</tr>
<tr>
<td align="left">status du Service</td>
<td align="left">arreter le Service</td>
</tr>
</tbody>
</table>
<h3 id="get-member">Get-Member<a class="headerlink" href="#get-member" title="Permanent link"></a></h3>
<p>Permet de connaître les propriétés <em>essentielles</em> d&rsquo;un objet.</p>
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">get-Service</span> <span class="p">|</span> <span class="nb">get-member</span>
</pre></div>

<p>Un objet est constitué de proprietes qui contiennent une valeur.</p>
<p>On peut modiifer la valeur d&rsquo;une propriété avec le verbe <code>Set</code></p>
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Set-Service</span> <span class="n">-Name</span> <span class="n">WSearch</span> <span class="n">-DisplayName</span> <span class="s2">&quot;Service de recherche Windows&quot;</span>
</pre></div>

<h3 id="les-objets-methodes">Les objets : methodes<a class="headerlink" href="#les-objets-methodes" title="Permanent link"></a></h3>
<p>Les objets disposent de méthodes  parfois communes à plusieurs types d&rsquo;objets.</p>
<p>Contrairement aux propriétés, les méthodes effectuent des actions sur la totalité de l&rsquo;objet ou sur la valeur d&rsquo;une ou plusieurs propriétés d&rsquo;un objet.</p>
<p><div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">get-date</span> <span class="p">|</span> <span class="n">gm</span>
<span class="n">PS</span><span class="p">&gt;</span> <span class="p">(</span><span class="nb">get-date</span><span class="p">).</span><span class="n">adddays</span><span class="p">(</span><span class="n">1</span><span class="p">)</span>
</pre></div>
<strong>Note</strong>:</p>
<ul>
<li><code>gm</code> est un alias de <code>Get-Member</code></li>
<li>ne modifie pas la valeur de <code>get-date</code>, c&rsquo;est juste un calcul fait sur une valeur.</li>
<li><code>Get-Date</code> est un objet <code>System.DateTime</code></li>
</ul>
<h3 id="tp-02-objet">TP 02 - Objet<a class="headerlink" href="#tp-02-objet" title="Permanent link"></a></h3>
<p><a href="tp02.html" target="_blank">Voir Atelier 2 - Les objets</a></p>
<p class="fin">~Fin Module 2~</p>

<h2 id="module-03-manipulation-des-objets">Module 03 - Manipulation des objets<a class="headerlink" href="#module-03-manipulation-des-objets" title="Permanent link"></a></h2>
<h3 id="manipuler-des-objets">Manipuler des objets<a class="headerlink" href="#manipuler-des-objets" title="Permanent link"></a></h3>
<p>En PowerShell, le résultat d&rsquo;une commande peut être composé d&rsquo;un ensemble d&rsquo;objets
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Service</span>
</pre></div></p>
<p>Le nombre d&rsquo;objets étant souvent élevé, il est important de pouvoir sélectionner et mettre en forme le résultat d&rsquo;une commande.
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-EventLog</span>
</pre></div></p>
<h4 id="pipeline">Pipeline<a class="headerlink" href="#pipeline" title="Permanent link"></a></h4>
<p>L&rsquo;utilisation de redirections au moyen de pipeline permet d&rsquo;effectuer des commandes de triage, de mise en forme, de sélection et de conditionner le résultat final. Peut être utilisé plusieurs fois.
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-EventLog</span> <span class="n">-LogName</span> <span class="s2">&quot;System&quot;</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">Name</span> <span class="p">|</span> <span class="nb">Format-Table</span>
</pre></div></p>
<p>Le pipe utilise la variable réservée <code>$PSItem</code>. Cela permet de cibler une propriété d&rsquo;un objet :
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Process</span> <span class="p">|</span> <span class="n">Select</span> <span class="n">Name</span><span class="p">,</span> <span class="n">Id</span> <span class="p">|</span> <span class="n">Where</span> <span class="p">{</span> <span class="nv">$PSItem</span><span class="p">.</span><span class="n">id</span> <span class="o">-gt</span> <span class="n">1500</span> <span class="o">-and</span> <span class="nv">$PSItem</span><span class="p">.</span><span class="n">id</span> <span class="o">-lt</span> <span class="n">2000</span> <span class="p">}</span>
</pre></div></p>
<h4 id="select-object">Select-Object<a class="headerlink" href="#select-object" title="Permanent link"></a></h4>
<p>La commande <code>Select-Object</code>  permet de sélectionner une ou plusieurs propriétés.</p>
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Service</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">-Property</span> <span class="n">Name</span><span class="p">,</span> <span class="n">Status</span>
<span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Service</span> <span class="p">|</span> <span class="n">Select</span> <span class="n">Name</span><span class="p">,</span> <span class="n">Status</span>
</pre></div>

<p>Parmi les propriétés de la fonction <code>Select</code> :
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Service</span> <span class="p">|</span> <span class="n">select</span> <span class="n">-First</span> <span class="n">5</span>       <span class="c"># les 5 premiers résultats</span>
<span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Service</span> <span class="p">|</span> <span class="n">Select</span> <span class="n">-Last</span> <span class="n">5</span>        <span class="c"># les 5 derniers</span>
<span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Service</span> <span class="p">|</span> <span class="n">Select</span> <span class="n">-Unique</span> <span class="n">Name</span>   <span class="c"># equiv. Distinct</span>
<span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Service</span> <span class="p">|</span> <span class="n">Select</span> <span class="n">-ExpandProperty</span> <span class="n">Name</span>   <span class="c"># affiche uniquement les valeurs dans la console</span>
</pre></div></p>
<h4 id="sort-object">Sort-Object<a class="headerlink" href="#sort-object" title="Permanent link"></a></h4>
<p>La commande <code>Sort-Object</code> permet de trier selon un critère donné.</p>
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Service</span> <span class="p">|</span> <span class="n">Select</span> <span class="n">Name</span><span class="p">,</span> <span class="n">Status</span> <span class="p">|</span> <span class="n">Sort</span> <span class="n">Status</span>
<span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Service</span> <span class="p">|</span> <span class="n">Select</span> <span class="n">Name</span><span class="p">,</span> <span class="n">id</span> <span class="p">|</span> <span class="n">Sort</span> <span class="n">id</span> <span class="n">-Descending</span>
</pre></div>

<p>Ex. La propriété <code>Length</code> indique le poids des fichiers en octets. Ils seront classés du plus faible au plus élevé.
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-ChildItem</span> <span class="n">-Path</span> <span class="n">C</span><span class="err">:</span><span class="p">\</span><span class="n">Windows</span> <span class="p">|</span> <span class="n">Sort</span> <span class="n">-Property</span> <span class="n">Length</span>
</pre></div></p>
<h4 id="measure-object">Measure-Object<a class="headerlink" href="#measure-object" title="Permanent link"></a></h4>
<p>La commande <code>Measure-Object</code> permet de compter le nombre d&rsquo;objets, d&rsquo;établir des moyennes, etc.</p>
<ul>
<li>
<p>L&rsquo;action par défaut est le <strong>comptage</strong>.
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Process</span> <span class="p">|</span> <span class="nb">Measure-Object</span>
</pre></div></p>
</li>
<li>
<p>La commande est aussi utilisable sur une propriété pour déterminer une valeur <strong>moyenne</strong>.
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-ChildItem</span> <span class="n">-Path</span> <span class="p">|</span> <span class="nb">Measure-Object</span> <span class="n">-Property</span> <span class="n">Length</span> <span class="n">-Average</span>
</pre></div></p>
</li>
<li>
<p>Sert aussi à calculer des valeurs <strong>minimales</strong> et <strong>maximales</strong>.
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-ChildItem</span> <span class="n">-Path</span> <span class="p">|</span> <span class="n">Measure</span> <span class="n">-Property</span> <span class="n">Length</span> <span class="n">-Minimum</span> <span class="n">-Maximum</span>
</pre></div></p>
</li>
</ul>
<h4 id="where-objet">Where-Objet<a class="headerlink" href="#where-objet" title="Permanent link"></a></h4>
<p>La commande <code>Where-Objet</code> conditionne la présence d&rsquo;un objet dans le résultat.</p>
<ul>
<li>Les conditions sont toujours appliquées sur des valeurs de propriété</li>
<li>Elles peuvent être uniques ou multiples, obligatoires ou optionnelles</li>
</ul>
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Service</span> <span class="p">|</span> <span class="n">Where</span> <span class="n">-Property</span> <span class="n">Status</span> <span class="o">-eq</span> <span class="s2">&quot;Running&quot;</span>
<span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Process</span> <span class="p">|</span> <span class="n">Where</span> <span class="n">-Property</span> <span class="n">Name</span> <span class="o">-like</span> <span class="s2">&quot;power*&quot;</span>
</pre></div>

<table>
<thead>
<tr>
<th align="left">Comparaison</th>
<th align="center">insensible à la casse</th>
<th align="center">Sensible à la casse</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Egalité</td>
<td align="center">-eq</td>
<td align="center">-ceq</td>
</tr>
<tr>
<td align="left">Inégalité</td>
<td align="center">-ne</td>
<td align="center">-cne</td>
</tr>
<tr>
<td align="left">Supérieur à</td>
<td align="center">-gt</td>
<td align="center">-cgt</td>
</tr>
<tr>
<td align="left">Sup. ou égal à</td>
<td align="center">-ge</td>
<td align="center">-cge</td>
</tr>
<tr>
<td align="left">Inférieur à</td>
<td align="center">-lt</td>
<td align="center">-clt</td>
</tr>
<tr>
<td align="left">Inf. ou égal à</td>
<td align="center">-le</td>
<td align="center">-cle</td>
</tr>
<tr>
<td align="left">égalité d&rsquo;expression</td>
<td align="center">-like</td>
<td align="center">-clike</td>
</tr>
<tr>
<td align="left">inégalité d&rsquo;expression</td>
<td align="center">-notlike</td>
<td align="center">-cnotlike</td>
</tr>
</tbody>
</table>
<h5 id="or-and-filterscript">OR / AND &amp; FilterScript<a class="headerlink" href="#or-and-filterscript" title="Permanent link"></a></h5>
<p>Pour ajouter des expressions logique à un Where-Objet :</p>
<p><strong>And</strong>
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Process</span> <span class="p">|</span> <span class="n">Select</span> <span class="n">Name</span><span class="p">,</span> <span class="n">Id</span> <span class="p">|</span> <span class="n">Where</span> <span class="n">-FilterScript</span> <span class="p">{</span> <span class="nv">$PSItem</span><span class="p">.</span><span class="n">id</span> <span class="o">-gt</span> <span class="n">1500</span> <span class="o">-and</span> <span class="nv">$PSItem</span><span class="p">.</span><span class="n">id</span> <span class="o">-lt</span> <span class="n">2000</span> <span class="p">}</span>
<span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Process</span> <span class="p">|</span> <span class="n">Select</span> <span class="n">Name</span><span class="p">,</span> <span class="n">Id</span> <span class="p">|</span> <span class="n">Where</span> <span class="n">-FilterScript</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">id</span> <span class="o">-eq</span> <span class="n">825</span> <span class="o">-and</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="o">-like</span> <span class="s2">&quot;power*&quot;</span> <span class="p">}</span>
</pre></div></p>
<p><strong>Or</strong>
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-LocalUser</span> <span class="p">|</span> <span class="n">Select</span> <span class="n">Name</span><span class="p">,</span> <span class="n">Sid</span><span class="p">,</span> <span class="n">Enabled</span> <span class="p">|</span> <span class="n">Where</span> <span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="o">-like</span> <span class="s2">&quot;Toto&quot;</span>
<span class="o">-or</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Sid</span> <span class="o">-eq</span> <span class="n">S</span><span class="p">-</span><span class="n">1</span><span class="p">-</span><span class="n">5</span><span class="p">-</span><span class="n">21</span><span class="p">-</span><span class="n">3376288570</span><span class="p">-</span><span class="n">2491860933</span><span class="p">-</span><span class="n">3167967787500</span>
<span class="o">-or</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Enabled</span> <span class="o">-eq</span> <span class="nv">$true</span> <span class="p">}</span>
</pre></div></p>
<p><strong>Important</strong> : penser à inclure les propriétés à tester dans le Select-Object.</p>
<h5 id="collaboration-de-conditions">Collaboration de conditions<a class="headerlink" href="#collaboration-de-conditions" title="Permanent link"></a></h5>
<p>Il est également possible de grouper des conditions</p>
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-ADUser</span> <span class="n">-Filter</span> <span class="p">*</span> <span class="p">|</span> <span class="n">Select</span> <span class="n">Name</span><span class="p">,</span> <span class="n">UserPrincipalName</span> <span class="p">|</span> <span class="n">Where</span> <span class="n">-FilterScript</span> <span class="p">{</span>
    <span class="p">(</span><span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="o">-eq</span> <span class="s2">&quot;Administrateur&quot;</span> <span class="o">-or</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="o">-eq</span> <span class="s2">&quot;Administrator&quot;</span><span class="p">)</span>
    <span class="o">-and</span>
    <span class="nv">$_</span><span class="p">.</span><span class="n">UserPrincipalName</span> <span class="o">-eq</span> <span class="s2">&quot;Admin&quot;</span>
<span class="p">}</span>
</pre></div>

<h4 id="format-table">Format-Table<a class="headerlink" href="#format-table" title="Permanent link"></a></h4>
<p>Permet de mettre en forme le résultat final afin d&rsquo;améliorer la lecture du résultat, mais également de permettre l&rsquo;export vers un fichier dans un ou plusieurs formats.</p>
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-ADUser</span> <span class="n">-Filter</span> <span class="p">*</span> <span class="p">|</span> <span class="n">Select</span> <span class="n">Name</span><span class="p">,</span><span class="n">GivenName</span><span class="p">,</span><span class="n">Enabled</span> <span class="p">|</span> <span class="nb">Format-Table</span>
</pre></div>

<ul>
<li>L&rsquo;ordre des colonnes est personnalisable
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-ADUser</span> <span class="n">-Filter</span> <span class="p">*</span> <span class="p">|</span> <span class="nb">Format-Table</span> <span class="n">-Property</span> <span class="n">Enabled</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">SamAccountName</span>
</pre></div></li>
<li>
<p>On peut également regrouper les objets par valeurs de propriétés identiques
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-ADUser</span> <span class="n">-Filter</span> <span class="p">*</span> <span class="p">|</span> <span class="nb">Format-Table</span> <span class="n">-GroupBy</span> <span class="n">Enabled</span>
</pre></div></p>
</li>
<li>
<p>Les utilisateurs seront regroupés selon l&rsquo;état de leur compte actif ou inactif.</p>
</li>
</ul>
<p><strong>Attention</strong> Select-Object n&rsquo;est pas obligatoire pour l&rsquo;utilisation des commandes de format.</p>
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Service</span> <span class="p">|</span> <span class="nb">Format-Table</span> <span class="n">-HideTableHeaders</span>    <span class="c"># masque le nom de la propriété, affichage brut</span>
<span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Service</span> <span class="p">|</span> <span class="nb">Format-Table</span> <span class="n">-Wrap</span>                <span class="c"># force le retour à la ligne en fin de console (wrap word)</span>
</pre></div>

<h4 id="format-wide">Format-Wide<a class="headerlink" href="#format-wide" title="Permanent link"></a></h4>
<p>Permet de mettre en forme les valeurs d&rsquo;une propriété en colonne. Le nombre de colonnes est paramétrable.</p>
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Service</span> <span class="p">|</span> <span class="nb">Format-Wide</span> <span class="n">-Column</span> <span class="n">10</span>
<span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Service</span> <span class="p">|</span> <span class="nb">Format-Wide</span> <span class="n">-AutoSize</span>
</pre></div>

<p>Avec <code>-AutoSize</code>, le nombre de colonnes est déterminé automatiquement.</p>
<h4 id="format-list">Format-List<a class="headerlink" href="#format-list" title="Permanent link"></a></h4>
<p>Permet de formater un affichage sous forme de liste. L&rsquo;ordre d&rsquo;affichage des propriétés est paramétrable dans la commande.</p>
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-ADUser</span> <span class="n">-Filter</span> <span class="p">*</span> <span class="p">|</span> <span class="nb">Format-List</span> <span class="n">-Property</span> <span class="n">Name</span><span class="p">,</span> <span class="n">Enabled</span><span class="p">,</span> <span class="n">SamAccountName</span>
<span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-ADUser</span> <span class="n">-Filter</span> <span class="p">*</span> <span class="p">|</span> <span class="n">fl</span> <span class="n">-Property</span> <span class="n">Name</span><span class="p">,</span> <span class="n">Enabled</span><span class="p">,</span> <span class="n">SamAccountName</span>
</pre></div>

<h4 id="export-object">Export-Object<a class="headerlink" href="#export-object" title="Permanent link"></a></h4>
<p>Permet d&rsquo;exporter un output dans un format donné (ex. csv). Les formats pris en charge nativement sont le CSV, le CLIXML, le JSON, le HTML.</p>
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-ADUser</span> <span class="n">-Filter</span> <span class="p">*</span> <span class="p">|</span> <span class="nb">Export-CSV</span> <span class="n">C</span><span class="err">:</span><span class="p">\</span><span class="n">ENI</span><span class="p">\</span><span class="n">export</span><span class="p">.</span><span class="n">csv</span> <span class="n">-Delimiter</span> <span class="s2">&quot;;&quot;</span>
<span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-ADUser</span> <span class="n">-Filter</span> <span class="p">*</span> <span class="p">|</span> <span class="nb">Export-CSV</span> <span class="n">C</span><span class="err">:</span><span class="p">\</span><span class="n">ENI</span><span class="p">\</span><span class="n">export</span><span class="p">.</span><span class="n">csv</span> <span class="n">-Delimiter</span> <span class="s2">&quot;;&quot;</span> <span class="n">-NoTypeInformation</span>
</pre></div>

<p>Par défaut le type d&rsquo;objet est exporté dans le fichier. La propriété <code>-NoTypeInformation</code> évite cela.</p>
<p>Pour les formats JSON et HTML, il faut convertir les données puis les exporter.</p>
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Service</span> <span class="p">|</span> <span class="nb">ConvertTo-Html</span> <span class="p">|</span> <span class="nb">Out-File</span> <span class="n">C</span><span class="err">:</span><span class="p">\</span><span class="n">ENI</span><span class="p">\</span><span class="n">Services</span><span class="p">.</span><span class="n">html</span>
</pre></div>

<p>Il existe des modules supplémentaires qui permettent de manipuler plus de formats (ex. Import-Excel).</p>
<h4 id="out-file">Out-File<a class="headerlink" href="#out-file" title="Permanent link"></a></h4>
<p>Permet de rediriger un flux vers un fichier (equiv. du chevron en bash).</p>
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Service</span> <span class="p">|</span> <span class="nb">Out-File</span> <span class="n">C</span><span class="err">:</span><span class="p">\</span><span class="n">ENI</span><span class="p">\</span><span class="n">Services</span><span class="p">.</span><span class="n">txt</span>
<span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Service</span> <span class="p">|</span> <span class="nb">Out-File</span> <span class="n">C</span><span class="err">:</span><span class="p">\</span><span class="n">ENI</span><span class="p">\</span><span class="n">Services</span><span class="p">.</span><span class="n">txt</span> <span class="n">-Append</span>
<span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Service</span> <span class="p">|</span> <span class="nb">Out-File</span> <span class="n">C</span><span class="err">:</span><span class="p">\</span><span class="n">ENI</span><span class="p">\</span><span class="n">Services</span><span class="p">.</span><span class="n">txt</span> <span class="n">-Width</span> <span class="n">42</span>   <span class="c"># défaut: 80</span>
</pre></div>

<ul>
<li><code>-Append</code> permet d&rsquo;ajouter en fin de fichier</li>
<li><code>-Width</code> spécifie le nombre de caractères par ligne. Par défaut 80.</li>
</ul>
<p><strong>Remarques</strong>: </p>
<ul>
<li>Le chevron à la Bash fonctionne aussi, dans les 2 sens. <code>&gt;</code>, <code>&gt;&gt;</code>, <code>&lt;</code>, <code>&lt;&lt;</code></li>
<li>Le <code>2&gt;</code> fonctionne aussi pour rediriger les erreurs. </li>
<li><code>$Null</code> est l&rsquo;équivalent du <code>/dev/null</code></li>
</ul>
<h4 id="get-content">Get-Content<a class="headerlink" href="#get-content" title="Permanent link"></a></h4>
<p>Permet d&rsquo;afficher le contenu d&rsquo;un fichier dans la console, on utilise la commande <code>Get-Content</code>.</p>
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Content</span> <span class="n">C</span><span class="err">:</span><span class="p">\</span><span class="n">User</span><span class="p">.</span><span class="n">csv</span>
<span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Content</span> <span class="p">|</span> <span class="n">C</span><span class="err">:</span><span class="p">\</span><span class="n">User</span><span class="p">.</span><span class="n">csv</span> <span class="n">-Tail</span> <span class="n">1</span>
</pre></div>

<h4 id="import-csv">Import-CSV<a class="headerlink" href="#import-csv" title="Permanent link"></a></h4>
<p>Permet d&rsquo;importer des données dans certains formats en vue d&rsquo;être manipuler dans le shell.</p>
<p>Exemple : Créer des comptes AD d&rsquo;après un csv importé
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Import-CSV</span> <span class="n">C</span><span class="err">:</span><span class="p">\</span><span class="n">users</span><span class="p">.</span><span class="n">csv</span> <span class="n">-Delimiter</span> <span class="s2">&quot;;&quot;</span> <span class="p">|</span> <span class="nb">New-ADUser</span>
</pre></div></p>
<p>Il n&rsquo;est pas possible de cibler une propriété du fichier CSV et de l&rsquo;attribuer à une propriété particulière d&rsquo;un objet.</p>
<div class="highlight"><pre><span class="c"># CETTE COMMANDE N&#39;EST PAS FONCTIONNELLE !</span>
<span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Import-CSV</span> <span class="n">C</span><span class="err">:</span><span class="p">\</span><span class="n">users</span><span class="p">.</span><span class="n">csv</span> <span class="n">-Delimiter</span> <span class="s2">&quot;;&quot;</span> <span class="p">|</span> <span class="nb">New-ADUser</span> <span class="n">-Name</span> <span class="nv">$_</span><span class="p">.</span><span class="n">nom</span> <span class="n">-GivenName</span> <span class="nv">$_</span><span class="p">.</span><span class="n">GivenName</span>
</pre></div>

<h3 id="les-proprietes-calculees">Les propriétés calculées<a class="headerlink" href="#les-proprietes-calculees" title="Permanent link"></a></h3>
<p>Lorsque les propriétés ne correspondent pas, il faut créer de nouvelles propriétés et récupérer la valeur de propriété d&rsquo;origine.</p>
<p>Cela peut être utile pour mieux interpréter le résultat d&rsquo;une commande, notamment en assurant la traduction de la propriété.</p>
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Import-CSV</span> <span class="n">c</span><span class="err">:</span><span class="p">\</span><span class="n">users</span><span class="p">.</span><span class="n">csv</span> <span class="n">-Delimiter</span> <span class="s2">&quot;;&quot;</span> <span class="p">|</span> <span class="nb">New-ADUser</span> <span class="n">-Name</span> <span class="nv">$_</span><span class="p">.</span><span class="n">nom</span> <span class="n">-GivenName</span> <span class="nv">$_</span><span class="p">.</span><span class="n">GivenName</span>
<span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Import-CSV</span> <span class="n">c</span><span class="err">:</span><span class="p">\</span><span class="n">users</span><span class="p">.</span><span class="n">csv</span> <span class="n">-Delimiter</span> <span class="s2">&quot;;&quot;</span> <span class="p">|</span> <span class="n">Select</span> <span class="n">GivenName</span> <span class="p">@{</span><span class="n">n</span><span class="p">=</span><span class="s1">&#39;Name&#39;</span><span class="p">;</span><span class="n">e</span><span class="p">={</span><span class="nv">$_</span><span class="p">.</span><span class="n">nom</span><span class="p">}}</span> <span class="p">|</span> <span class="nb">New-ADUser</span> <span class="n">-Name</span> <span class="nv">$_</span><span class="p">.</span><span class="n">Name</span> <span class="n">-GivenName</span> <span class="nv">$_</span><span class="p">.</span><span class="n">GivenName</span>
</pre></div>

<ul>
<li><code>n=Name</code>        : nouvelle étiquette de la propriété</li>
<li><code>e={$_.nom}</code>    : nom de la propriété dont la valeur va être récupérée</li>
<li><code>-Name $_.Name</code> : utilisation de la nouvelle propriété avec son nouveau label</li>
</ul>
<p>On peut également changer l&rsquo;<strong>unité de mesure</strong> remontée par les commandes.</p>
<p>Ex. la propriété <strong>Length</strong> est affiché en octet. On peut se servir des propriétés calculées pour afficher un résultat &ldquo;<em>human-readable</em>&rdquo;.</p>
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-ChildItem</span> <span class="o">-File</span> <span class="p">|</span> <span class="n">Select</span> <span class="n">Name</span><span class="p">,</span>
    <span class="p">@{</span>
        <span class="n">n</span><span class="p">=</span><span class="s1">&#39;Taille&#39;</span><span class="p">;</span>
        <span class="n">e</span><span class="p">={</span> <span class="s1">&#39;{0:N2}&#39;</span> <span class="o">-f</span> <span class="p">(</span><span class="nv">$_</span><span class="p">.</span><span class="n">Length</span> <span class="p">/</span> <span class="n">1MB</span><span class="p">)</span> <span class="p">}</span>
    <span class="p">}</span>
</pre></div>

<ul>
<li><code>'{0:N2}'</code> : numérique à 2 décimales</li>
<li><code>($_.Length / 1MB)</code> : La conversion est faite en bytes et non en octets.</li>
</ul>
<p>Explications supplémentaires sur les formats : <a href="https://docs.microsoft.com/fr-fr/dotnet/standard/base-types/standard-numeric-format-strings">https://docs.microsoft.com/fr-fr/dotnet/standard/base-types/standard-numeric-format-strings</a></p>
<p>On peut également intégrer plusieurs propriétés calculées dans une même commande.</p>
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Volume</span> <span class="p">|</span> <span class="n">Select</span> <span class="n">DriveLetter</span><span class="p">,</span>
    <span class="p">@{</span>
        <span class="n">n</span><span class="p">=</span><span class="s1">&#39;Taille (GB)&#39;</span><span class="p">;</span>
        <span class="n">e</span><span class="p">={</span><span class="s1">&#39;{0:N2}&#39;</span> <span class="o">-f</span> <span class="p">(</span><span class="nv">$PSItem</span><span class="p">.</span><span class="n">Size</span> <span class="p">/</span> <span class="n">1GB</span><span class="p">)}</span>
    <span class="p">},</span>
    <span class="p">@{</span>
        <span class="n">n</span><span class="p">=</span><span class="s1">&#39;Espace Libre (GB)&#39;</span><span class="p">;</span>
        <span class="n">e</span><span class="p">={</span><span class="s1">&#39;{0:N2}&#39;</span> <span class="o">-f</span> <span class="p">(</span><span class="nv">$PSItem</span><span class="p">.</span><span class="n">SizeRemaining</span> <span class="p">/</span> <span class="n">1GB</span><span class="p">)}</span>
    <span class="p">}</span>
</pre></div>

<p class="fin">~Fin Module 3~</p>

<h2 id="module-4-structures-et-variables">Module 4 - Structures et Variables<a class="headerlink" href="#module-4-structures-et-variables" title="Permanent link"></a></h2>
<h3 id="structures-de-controle">Structures de contrôle<a class="headerlink" href="#structures-de-controle" title="Permanent link"></a></h3>
<h4 id="if">if<a class="headerlink" href="#if" title="Permanent link"></a></h4>
<div class="highlight"><pre><span class="k">if</span> <span class="p">(</span><span class="nv">$x</span> <span class="o">-eq</span> <span class="nv">$y</span><span class="p">)</span> <span class="p">{</span>
    <span class="c"># do stuff</span>
<span class="p">}</span> <span class="k">elseif</span> <span class="p">(</span><span class="nv">$x</span> <span class="n">_eq</span> <span class="nv">$z</span><span class="p">)</span> <span class="p">{</span>
    <span class="c"># do other stuff</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="c"># or else do stuff</span>
<span class="p">}</span>
</pre></div>

<h4 id="while-do-while">while / do while<a class="headerlink" href="#while-do-while" title="Permanent link"></a></h4>
<p>Boucle tourne tant que la condition d&rsquo;arrêt est <strong>$false</strong>.</p>
<p><div class="highlight"><pre><span class="nv">$x</span> <span class="p">=</span> <span class="s1">&#39;pouet&#39;</span>
<span class="k">while</span> <span class="p">(</span><span class="nv">$x</span> <span class="o">-ne</span> <span class="s1">&#39;q&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$x</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;Veuillez saisir...&quot;</span>
<span class="p">}</span>
</pre></div>
<div class="highlight"><pre><span class="k">do</span> <span class="p">{</span>
    <span class="nv">$x</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;Veuillez saisir...&quot;</span>
<span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="nv">$x</span> <span class="o">-ne</span> <span class="s1">&#39;q&#39;</span><span class="p">)</span>
</pre></div></p>
<h4 id="until-do-until">until / do until<a class="headerlink" href="#until-do-until" title="Permanent link"></a></h4>
<p>Boucle tourne jusqu&rsquo;à ce que la condition d&rsquo;arrêt soit <strong>$true</strong>.</p>
<p><div class="highlight"><pre><span class="k">until</span> <span class="p">(</span><span class="nv">$x</span> <span class="o">-eq</span> <span class="s1">&#39;q&#39;</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$x</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;Veuillez saisir...&quot;</span>
<span class="p">}</span>
</pre></div>
<div class="highlight"><pre><span class="k">do</span> <span class="p">{</span>
    <span class="nv">$x</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;Veuillez saisir...&quot;</span>
<span class="p">}</span> <span class="k">until</span> <span class="p">(</span><span class="nv">$x</span> <span class="o">-eq</span> <span class="s1">&#39;q&#39;</span><span class="p">)</span>
</pre></div></p>
<h4 id="for">for<a class="headerlink" href="#for" title="Permanent link"></a></h4>
<p>Boucle tant que la condition est <strong>$true</strong>.</p>
<div class="highlight"><pre><span class="k">for</span><span class="p">(</span><span class="nv">$i</span><span class="p">=</span><span class="n">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="p">&lt;</span> <span class="n">10</span><span class="p">;</span> <span class="nv">$i</span><span class="p">++)</span> <span class="p">{</span>
    <span class="c"># do stuff</span>
<span class="p">}</span>
</pre></div>

<p><strong>Multiple operations</strong></p>
<div class="highlight"><pre><span class="c"># Comma separated assignment expressions enclosed in parenthesis.</span>
<span class="k">for</span> <span class="p">((</span><span class="nv">$i</span> <span class="p">=</span> <span class="n">0</span><span class="p">),</span> <span class="p">(</span><span class="nv">$j</span> <span class="p">=</span> <span class="n">0</span><span class="p">);</span> <span class="nv">$i</span> <span class="o">-lt</span> <span class="n">10</span><span class="p">;</span> <span class="nv">$i</span><span class="p">++)</span> <span class="p">{</span>
    <span class="s2">&quot;</span><span class="se">`$</span><span class="s2">i:$i&quot;</span>
    <span class="s2">&quot;</span><span class="se">`$</span><span class="s2">j:$j&quot;</span>
<span class="p">}</span>

<span class="c"># Sub-expression using the semicolon to separate statements.</span>
<span class="k">for</span> <span class="p">($(</span><span class="nv">$i</span> <span class="p">=</span> <span class="n">0</span><span class="p">;</span><span class="nv">$j</span> <span class="p">=</span> <span class="n">0</span><span class="p">);</span> <span class="nv">$i</span> <span class="o">-lt</span> <span class="n">10</span><span class="p">;</span> <span class="nv">$i</span><span class="p">++)</span> <span class="p">{</span>
    <span class="s2">&quot;</span><span class="se">`$</span><span class="s2">i:$i&quot;</span>
    <span class="s2">&quot;</span><span class="se">`$</span><span class="s2">j:$j&quot;</span>
<span class="p">}</span>

<span class="c"># Comma separated assignment expressions.</span>
<span class="k">for</span> <span class="p">((</span><span class="nv">$i</span> <span class="p">=</span> <span class="n">0</span><span class="p">),</span> <span class="p">(</span><span class="nv">$j</span> <span class="p">=</span> <span class="n">0</span><span class="p">);</span> <span class="nv">$i</span> <span class="o">-lt</span> <span class="n">10</span><span class="p">;</span> <span class="nv">$i</span><span class="p">++,</span> <span class="nv">$j</span><span class="p">++)</span> <span class="p">{</span>
    <span class="s2">&quot;</span><span class="se">`$</span><span class="s2">i:$i&quot;</span>
    <span class="s2">&quot;</span><span class="se">`$</span><span class="s2">j:$j&quot;</span>
<span class="p">}</span>

<span class="c"># Comma separated assignment expressions enclosed in parenthesis.</span>
<span class="k">for</span> <span class="p">((</span><span class="nv">$i</span> <span class="p">=</span> <span class="n">0</span><span class="p">),</span> <span class="p">(</span><span class="nv">$j</span> <span class="p">=</span> <span class="n">0</span><span class="p">);</span> <span class="nv">$i</span> <span class="o">-lt</span> <span class="n">10</span><span class="p">;</span> <span class="p">(</span><span class="nv">$i</span><span class="p">++),</span> <span class="p">(</span><span class="nv">$j</span><span class="p">++))</span> <span class="p">{</span>
    <span class="s2">&quot;</span><span class="se">`$</span><span class="s2">i:$i&quot;</span>
    <span class="s2">&quot;</span><span class="se">`$</span><span class="s2">j:$j&quot;</span>
<span class="p">}</span>

<span class="c"># Sub-expression using the semicolon to separate statements.</span>
<span class="k">for</span> <span class="p">($(</span><span class="nv">$i</span> <span class="p">=</span> <span class="n">0</span><span class="p">;</span><span class="nv">$j</span> <span class="p">=</span> <span class="n">0</span><span class="p">);</span> <span class="nv">$i</span> <span class="o">-lt</span> <span class="n">10</span><span class="p">;</span> <span class="p">$(</span><span class="nv">$i</span><span class="p">++;</span><span class="nv">$j</span><span class="p">++))</span> <span class="p">{</span>
    <span class="s2">&quot;</span><span class="se">`$</span><span class="s2">i:$i&quot;</span>
    <span class="s2">&quot;</span><span class="se">`$</span><span class="s2">j:$j&quot;</span>
<span class="p">}</span>

<span class="k">for</span> <span class="p">((</span><span class="nv">$i</span> <span class="p">=</span> <span class="n">0</span><span class="p">),</span> <span class="p">(</span><span class="nv">$j</span> <span class="p">=</span> <span class="n">0</span><span class="p">);</span> <span class="nv">$i</span> <span class="o">-lt</span> <span class="n">10</span> <span class="o">-and</span> <span class="nv">$j</span> <span class="o">-lt</span> <span class="n">10</span><span class="p">;</span> <span class="nv">$i</span><span class="p">++,</span><span class="nv">$j</span><span class="p">++)</span> <span class="p">{</span>
    <span class="s2">&quot;</span><span class="se">`$</span><span class="s2">i:$i&quot;</span>
    <span class="s2">&quot;</span><span class="se">`$</span><span class="s2">j:$j&quot;</span>
<span class="p">}</span>
</pre></div>

<p>Voir <em><code>Get-Help about_logical_operators</code></em></p>
<h4 id="foreach">foreach<a class="headerlink" href="#foreach" title="Permanent link"></a></h4>
<div class="highlight"><pre><span class="nv">$liste</span> <span class="p">=</span> <span class="nb">Get-ADUser</span> <span class="n">-filter</span> <span class="p">*</span>
<span class="k">foreach</span><span class="p">(</span><span class="nv">$item</span> <span class="k">in</span> <span class="nv">$liste</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">write-host</span> <span class="s2">&quot;Username : $item.Name&quot;</span>
    <span class="nb">write-host</span> <span class="s2">&quot;Surname  : $item.Surname&quot;</span>
<span class="p">}</span>
</pre></div>

<h4 id="switch">switch<a class="headerlink" href="#switch" title="Permanent link"></a></h4>
<div class="highlight"><pre><span class="k">switch</span><span class="p">(</span><span class="nv">$ADGroup</span><span class="p">)</span> <span class="p">{</span>
    <span class="s2">&quot;User&quot;</span> <span class="p">{</span>
        <span class="nb">write-host</span> <span class="s2">&quot;Le groupe est Utilisateur&quot;</span>
    <span class="p">}</span>
    <span class="s2">&quot;Administrator&quot;</span> <span class="p">{</span>
        <span class="nb">write-host</span> <span class="s2">&quot;Le groupe est Administrateur&quot;</span>
    <span class="p">}</span>
    <span class="s2">&quot;Default&quot;</span> <span class="p">{</span>
        <span class="nb">write-host</span> <span class="s2">&quot;Le groupe n&#39;est pas valide&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p><strong>Note</strong>: Si plusieurs valeurs correspondent au critère, tous les blocs d&rsquo;actions correspondant sont appliqués.</p>
<h3 id="caracteristiques">Caractéristiques<a class="headerlink" href="#caracteristiques" title="Permanent link"></a></h3>
<h4 id="incrementation">Incrémentation<a class="headerlink" href="#incrementation" title="Permanent link"></a></h4>
<div class="highlight"><pre><span class="nv">$compteur</span> <span class="p">=</span> <span class="n">1</span>
<span class="nv">$compteur</span> <span class="p">+=</span> <span class="n">1</span>
<span class="nv">$compteur</span><span class="p">++</span>       <span class="c"># à vérifier</span>
</pre></div>

<h4 id="concatenation-1">Concaténation 1<a class="headerlink" href="#concatenation-1" title="Permanent link"></a></h4>
<div class="highlight"><pre><span class="nb">write-host</span> <span class="s2">&quot;Ceci est le &quot;</span> <span class="nv">$compteur</span> <span class="s2">&quot;e tours&quot;</span>
</pre></div>

<h4 id="definition-affectation-de-variable">Définition / Affectation de variable<a class="headerlink" href="#definition-affectation-de-variable" title="Permanent link"></a></h4>
<div class="highlight"><pre><span class="nv">$foo</span> <span class="p">=</span> <span class="n">1</span>                         <span class="c"># type int </span>
<span class="nv">$user</span> <span class="p">=</span> <span class="nb">Get-ADUser</span> <span class="n">-filter</span> <span class="p">*</span>     <span class="c"># type object </span>
<span class="nv">$str</span> <span class="p">=</span> <span class="s2">&quot;Hi&quot;</span>                      <span class="c"># type string </span>
</pre></div>

<h4 id="acces-variable">Accès Variable<a class="headerlink" href="#acces-variable" title="Permanent link"></a></h4>
<p>Pour connaître le type d&rsquo;une variable 
<div class="highlight"><pre><span class="nv">$a</span><span class="p">.</span><span class="n">GetType</span><span class="p">()</span>     <span class="c"># accès aux méthodes</span>
<span class="nv">$a</span><span class="p">.</span><span class="n">count</span>         <span class="c"># accès aux propriétés</span>
</pre></div></p>
<h4 id="comment">Comment<a class="headerlink" href="#comment" title="Permanent link"></a></h4>
<div class="highlight"><pre><span class="c"># Ceci est un commentaire </span>

<span class="cm">&lt;# Commentaire </span>
<span class="cm">   Multiline #&gt;</span>
</pre></div>

<h4 id="specificites-powershell">Spécificités Powershell<a class="headerlink" href="#specificites-powershell" title="Permanent link"></a></h4>
<p>Afficher les variables actuellement déclarées dans la console.</p>
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">Get-Variable</span>
</pre></div>

<h4 id="lire-input">Lire input<a class="headerlink" href="#lire-input" title="Permanent link"></a></h4>
<div class="highlight"><pre><span class="nv">$a</span> <span class="p">=</span> <span class="nb">Read-Host</span> <span class="s2">&quot;Veuillez saisir...&quot;</span>
</pre></div>

<h4 id="ecrire-output">Ecrire output<a class="headerlink" href="#ecrire-output" title="Permanent link"></a></h4>
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nb">write-host</span> <span class="s2">&quot;Blabla&quot;</span>
<span class="n">PS</span><span class="p">&gt;</span> <span class="nb">write-host</span> <span class="s2">&quot;blabla alias $foo&quot;</span>     <span class="c"># var dans echo </span>
</pre></div>

<h4 id="variables-de-type-object">Variables de type Object<a class="headerlink" href="#variables-de-type-object" title="Permanent link"></a></h4>
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nv">$service</span><span class="p">.</span><span class="n">ServiceName</span>     <span class="c"># accès propriété</span>
<span class="n">PS</span><span class="p">&gt;</span> <span class="nv">$ADUser</span><span class="p">[</span><span class="n">2</span><span class="p">]</span>               <span class="c"># 3e utilisateur </span>
<span class="n">PS</span><span class="p">&gt;</span> <span class="nv">$Service</span><span class="p">[</span><span class="n">3</span><span class="p">].</span><span class="n">stop</span><span class="p">()</span>       <span class="c"># accès méthode</span>
</pre></div>

<h4 id="convertisseur-de-valeur-transtypage">Convertisseur de valeur (transtypage ?)<a class="headerlink" href="#convertisseur-de-valeur-transtypage" title="Permanent link"></a></h4>
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="nv">$date</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Get-Date</span><span class="p">).</span><span class="n">toString</span><span class="p">(</span><span class="s2">&quot;yyyyMMdd&quot;</span><span class="p">)</span>
<span class="n">PS</span><span class="p">&gt;</span> <span class="nv">$date</span><span class="p">.</span><span class="n">GetType</span><span class="p">()</span>                          <span class="c"># String !!</span>
</pre></div>

<h4 id="concatenation-de-string-operateur">Concaténation de string (opérateur <code>+</code>)<a class="headerlink" href="#concatenation-de-string-operateur" title="Permanent link"></a></h4>
<p><div class="highlight"><pre><span class="nv">$a</span> <span class="p">=</span> <span class="s2">&quot;foo&quot;</span>
<span class="nv">$b</span> <span class="p">=</span> <span class="s2">&quot;bar&quot;</span>
<span class="nv">$c</span> <span class="p">=</span> <span class="nv">$a</span> <span class="p">+</span> <span class="nv">$b</span>      <span class="c"># =&gt; &quot;foobar&quot;</span>
</pre></div>
<div class="highlight"><pre><span class="nv">$d</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Get-ADUser</span> <span class="n">-filter</span> <span class="p">*)</span>
<span class="nv">$e</span> <span class="p">=</span> <span class="nv">$d</span><span class="p">.</span><span class="n">Name</span> 
<span class="nv">$f</span> <span class="p">=</span> <span class="nv">$d</span><span class="p">.</span><span class="n">Surname</span> 
<span class="nv">$g</span> <span class="p">=</span> <span class="nv">$e</span> <span class="p">+</span> <span class="nv">$f</span>      <span class="c"># =&gt; &quot;Toto le Haricot&quot;</span>
</pre></div></p>
<p><strong>ATTENTION</strong> il faut impérativement que les variables concaténées soient toutes du même type.</p>
<h3 id="operations-multi-types">Opérations multi-types<a class="headerlink" href="#operations-multi-types" title="Permanent link"></a></h3>
<p><strong>Notes</strong>: c&rsquo;est le type du premier élément qui prend le dessus</p>
<div class="highlight"><pre><span class="n">PS</span><span class="p">&gt;</span> <span class="n">1</span> <span class="p">+</span> <span class="n">2</span>
<span class="n">3</span>
<span class="n">PS</span><span class="p">&gt;</span> <span class="s2">&quot;1&quot;</span><span class="p">+</span><span class="s2">&quot;2&quot;</span>
<span class="n">12</span>
<span class="n">PS</span><span class="p">&gt;</span> <span class="s2">&quot;1&quot;</span> <span class="p">+</span> <span class="n">2</span>
<span class="n">12</span>
<span class="n">PS</span><span class="p">&gt;</span> <span class="n">1</span> <span class="p">+</span> <span class="s2">&quot;2&quot;</span>
<span class="n">3</span>
</pre></div>

<h3 id="type-int">Type Int<a class="headerlink" href="#type-int" title="Permanent link"></a></h3>
<p><div class="highlight"><pre><span class="nv">$a</span> <span class="p">=</span> <span class="n">1</span>
<span class="nv">$b</span> <span class="p">=</span> <span class="n">2</span> 
<span class="nv">$c</span> <span class="p">=</span> <span class="nv">$a</span> <span class="p">+</span> <span class="nv">$b</span>
</pre></div>
<div class="highlight"><pre><span class="nv">$d</span> <span class="p">=</span> <span class="nb">Get-Process</span>
<span class="nv">$e</span> <span class="p">=</span> <span class="nv">$d</span><span class="p">[</span><span class="n">1</span><span class="p">].</span><span class="n">id</span> 
<span class="nv">$f</span> <span class="p">=</span> <span class="nv">$d</span><span class="p">[</span><span class="n">2</span><span class="p">].</span><span class="n">id</span> 
<span class="nv">$g</span> <span class="p">=</span> <span class="nv">$e</span> <span class="p">-</span> <span class="nv">$f</span> 

<span class="c"># =&gt; id du process 1 - id du process 2</span>
</pre></div></p>
<h3 id="type-array">Type Array<a class="headerlink" href="#type-array" title="Permanent link"></a></h3>
<div class="highlight"><pre><span class="c"># Definition</span>
<span class="nv">$array</span> <span class="p">=</span> <span class="s2">&quot;PC1&quot;</span><span class="p">,</span> <span class="s2">&quot;PC2&quot;</span><span class="p">,</span> <span class="s2">&quot;PC3&quot;</span>
<span class="nv">$array</span><span class="p">[</span><span class="n">0</span><span class="p">]</span>                     <span class="c"># PC1</span>

<span class="c"># Ajout (à la fin)</span>
<span class="nv">$arr</span> <span class="p">+=</span> <span class="s2">&quot;PC4&quot;</span>                 <span class="c"># PC1, PC2, PC3, PC4</span>

<span class="c"># Remplacer</span>
<span class="nv">$arr</span><span class="p">.</span><span class="n">Replace</span><span class="p">(</span><span class="s2">&quot;PC1&quot;</span><span class="p">,</span> <span class="s2">&quot;PC4&quot;</span><span class="p">)</span>    <span class="c"># PC4, PC2, PC3, PC4</span>
</pre></div>

<p><strong>Important</strong> : les arrays sont de <strong>taille fixe</strong>. On ne peut pas supprimer de valeur. (valeur de isFixedSize est à $true)</p>
<p><strong>Note</strong>: </p>
<ul>
<li>L&rsquo;opérateur <code>+=</code> détruit le tableau et le reconstruit avec l&rsquo;élément ajouté. </li>
<li>Voir plus d&rsquo;infos sur <em><code>Get-Help about-array</code></em>.</li>
</ul>
<p class="fin">~Fin Module 4~</p>

<p><link rel="stylesheet" type="text/css" href=".ressources/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href=".ressources/css/style.css">
<link rel="stylesheet" type="text/css" href=".ressources/css/headings.css"></p></article></body></html>